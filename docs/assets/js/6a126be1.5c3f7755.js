"use strict";(self.webpackChunkdocusaurus=self.webpackChunkdocusaurus||[]).push([[183],{1177:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>l,contentTitle:()=>a,default:()=>h,frontMatter:()=>r,metadata:()=>s,toc:()=>o});const s=JSON.parse('{"id":"internals/random-padding","title":"Randomized Padding","description":"Random Padding Example","source":"@site/docs/internals/random-padding.md","sourceDirName":"internals","slug":"/internals/random-padding","permalink":"/lightweight-secure-tcp/docs/internals/random-padding","draft":false,"unlisted":false,"editUrl":"https://github.com/sDenizOzturk/lightweight-secure-tcp/tree/main/docusaurus/docs/internals/random-padding.md","tags":[],"version":"current","sidebarPosition":4,"frontMatter":{"title":"Randomized Padding","sidebar_position":4},"sidebar":"tutorialSidebar","previous":{"title":"KeepAlive Mechanism","permalink":"/lightweight-secure-tcp/docs/internals/keep-alive"},"next":{"title":"XTEA256 Encryption","permalink":"/lightweight-secure-tcp/docs/internals/xtea256"}}');var d=i(4848),t=i(8453);const r={title:"Randomized Padding",sidebar_position:4},a="Randomized Padding",l={},o=[{value:"\ud83d\udce6 Why Padding Is Needed",id:"-why-padding-is-needed",level:2},{value:"\ud83e\uddea How It Works",id:"-how-it-works",level:2},{value:"\ud83d\udee1\ufe0f How Padding Prevents Key Recovery",id:"\ufe0f-how-padding-prevents-key-recovery",level:2},{value:"\ud83e\udde0 Benefits",id:"-benefits",level:2}];function c(e){const n={br:"br",code:"code",h1:"h1",h2:"h2",header:"header",hr:"hr",img:"img",li:"li",p:"p",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(n.header,{children:(0,d.jsx)(n.h1,{id:"randomized-padding",children:"Randomized Padding"})}),"\n",(0,d.jsx)(n.p,{children:(0,d.jsx)(n.img,{alt:"Random Padding Example",src:i(3783).A+"",width:"1600",height:"1126"})}),"\n",(0,d.jsx)(n.hr,{}),"\n",(0,d.jsx)(n.h2,{id:"-why-padding-is-needed",children:"\ud83d\udce6 Why Padding Is Needed"}),"\n",(0,d.jsxs)(n.p,{children:["XTEA256 (like most block ciphers) encrypts data in ",(0,d.jsx)(n.strong,{children:"8-byte blocks"}),".",(0,d.jsx)(n.br,{}),"\n","If your message is not a multiple of 8 bytes, it needs to be padded."]}),"\n",(0,d.jsx)(n.hr,{}),"\n",(0,d.jsx)(n.h2,{id:"-how-it-works",children:"\ud83e\uddea How It Works"}),"\n",(0,d.jsxs)(n.p,{children:["Instead of adding fixed padding bytes, ",(0,d.jsx)(n.strong,{children:"random values"})," are added to fill the last block."]}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsx)(n.li,{children:"The length of the actual message is stored separately"}),"\n",(0,d.jsx)(n.li,{children:"Padding is stripped after decryption"}),"\n",(0,d.jsxs)(n.li,{children:["Each encryption attempt generates a ",(0,d.jsx)(n.strong,{children:"different encrypted result"}),", even for identical messages"]}),"\n"]}),"\n",(0,d.jsx)(n.hr,{}),"\n",(0,d.jsx)(n.h2,{id:"\ufe0f-how-padding-prevents-key-recovery",children:"\ud83d\udee1\ufe0f How Padding Prevents Key Recovery"}),"\n",(0,d.jsxs)(n.p,{children:["Without random padding, encrypted packets would always end in predictable bytes",(0,d.jsx)(n.br,{}),"\n","(like multiple ",(0,d.jsx)(n.code,{children:"0x00"})," values). This can leak information when decrypting with the wrong key."]}),"\n",(0,d.jsx)(n.p,{children:"For example:"}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsx)(n.li,{children:"If your message is 1 byte, the last 7 bytes will be padding"}),"\n",(0,d.jsxs)(n.li,{children:["Without randomness, these 7 bytes would always be the same (e.g. ",(0,d.jsx)(n.code,{children:"0x00"}),")"]}),"\n",(0,d.jsx)(n.li,{children:'An attacker could try random keys and check if the decrypted padding looks "valid"'}),"\n"]}),"\n",(0,d.jsx)(n.p,{children:"This would make it easier to guess or brute-force the session key over time."}),"\n",(0,d.jsx)(n.p,{children:"By using random padding:"}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsx)(n.li,{children:"Each decryption attempt produces unpredictable results"}),"\n",(0,d.jsx)(n.li,{children:'There\'s no way to verify if a wrong key was "almost correct"'}),"\n",(0,d.jsx)(n.li,{children:"The padding cannot be guessed, making key recovery practically impossible"}),"\n"]}),"\n",(0,d.jsx)(n.hr,{}),"\n",(0,d.jsx)(n.h2,{id:"-benefits",children:"\ud83e\udde0 Benefits"}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsx)(n.li,{children:"\u274c Prevents detecting repeated messages"}),"\n",(0,d.jsx)(n.li,{children:"\ud83d\udd10 Makes it impossible to compare encrypted payloads"}),"\n",(0,d.jsx)(n.li,{children:"\ud83d\udd04 Protects against pattern analysis"}),"\n",(0,d.jsx)(n.li,{children:"\ud83e\udde9 Ensures that each packet appears unique, even if message is the same"}),"\n"]}),"\n",(0,d.jsx)(n.hr,{}),"\n",(0,d.jsxs)(n.p,{children:["Randomized padding is automatically handled by the library.",(0,d.jsx)(n.br,{}),"\n","You don\u2019t need to manually add or remove it."]})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,d.jsx)(n,{...e,children:(0,d.jsx)(c,{...e})}):c(e)}},3783:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/random-padding-1b6df9cbe583e50b277d6f5a90564e50.png"},8453:(e,n,i)=>{i.d(n,{R:()=>r,x:()=>a});var s=i(6540);const d={},t=s.createContext(d);function r(e){const n=s.useContext(t);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(d):e.components||d:r(e.components),s.createElement(t.Provider,{value:n},e.children)}}}]);